var cov_21lppx8eza=function(){var path='/usr/src/app/lib/csv_parser.js',hash='2ddb930560d3a25e4f485703913db0d9be7dde35',Function=function(){}.constructor,global=new Function('return this')(),gcv='__coverage__',coverageData={path:'/usr/src/app/lib/csv_parser.js',statementMap:{'0':{start:{line:1,column:16},end:{line:1,column:34}},'1':{start:{line:2,column:13},end:{line:2,column:28}},'2':{start:{line:3,column:12},end:{line:3,column:33}},'3':{start:{line:6,column:2},end:{line:7,column:35}},'4':{start:{line:7,column:4},end:{line:7,column:35}},'5':{start:{line:9,column:2},end:{line:9,column:21}},'6':{start:{line:11,column:2},end:{line:11,column:41}},'7':{start:{line:12,column:2},end:{line:12,column:51}},'8':{start:{line:13,column:2},end:{line:13,column:26}},'9':{start:{line:15,column:19},end:{line:15,column:36}},'10':{start:{line:16,column:15},end:{line:16,column:19}},'11':{start:{line:18,column:2},end:{line:32,column:4}},'12':{start:{line:19,column:4},end:{line:28,column:8}},'13':{start:{line:20,column:6},end:{line:28,column:8}},'14':{start:{line:20,column:48},end:{line:27,column:27}},'15':{start:{line:30,column:4},end:{line:30,column:38}},'16':{start:{line:31,column:4},end:{line:31,column:31}},'17':{start:{line:33,column:2},end:{line:33,column:47}},'18':{start:{line:33,column:29},end:{line:33,column:45}},'19':{start:{line:36,column:0},end:{line:36,column:34}},'20':{start:{line:38,column:0},end:{line:38,column:31}},'21':{start:{line:40,column:0},end:{line:40,column:30}},'22':{start:{line:42,column:0},end:{line:55,column:2}},'23':{start:{line:43,column:2},end:{line:51,column:7}},'24':{start:{line:44,column:4},end:{line:51,column:7}},'25':{start:{line:52,column:2},end:{line:53,column:18}},'26':{start:{line:53,column:4},end:{line:53,column:18}},'27':{start:{line:54,column:2},end:{line:54,column:30}},'28':{start:{line:57,column:0},end:{line:72,column:2}},'29':{start:{line:58,column:14},end:{line:58,column:38}},'30':{start:{line:59,column:2},end:{line:69,column:3}},'31':{start:{line:60,column:4},end:{line:68,column:5}},'32':{start:{line:61,column:6},end:{line:61,column:25}},'33':{start:{line:63,column:24},end:{line:63,column:51}},'34':{start:{line:64,column:6},end:{line:67,column:26}},'35':{start:{line:65,column:8},end:{line:65,column:37}},'36':{start:{line:66,column:11},end:{line:67,column:26}},'37':{start:{line:67,column:8},end:{line:67,column:26}},'38':{start:{line:70,column:2},end:{line:70,column:27}},'39':{start:{line:71,column:2},end:{line:71,column:17}},'40':{start:{line:74,column:0},end:{line:77,column:2}},'41':{start:{line:75,column:2},end:{line:75,column:17}},'42':{start:{line:76,column:2},end:{line:76,column:52}},'43':{start:{line:76,column:22},end:{line:76,column:50}},'44':{start:{line:79,column:0},end:{line:79,column:28}}},fnMap:{'0':{name:'Csv_parser',decl:{start:{line:5,column:9},end:{line:5,column:19}},loc:{start:{line:5,column:29},end:{line:34,column:1}},line:5},'1':{name:'(anonymous_1)',decl:{start:{line:18,column:22},end:{line:18,column:23}},loc:{start:{line:18,column:33},end:{line:32,column:3}},line:18},'2':{name:'(anonymous_2)',decl:{start:{line:20,column:38},end:{line:20,column:39}},loc:{start:{line:20,column:48},end:{line:27,column:27}},line:20},'3':{name:'(anonymous_3)',decl:{start:{line:33,column:21},end:{line:33,column:22}},loc:{start:{line:33,column:29},end:{line:33,column:45}},line:33},'4':{name:'(anonymous_4)',decl:{start:{line:42,column:27},end:{line:42,column:28}},loc:{start:{line:42,column:39},end:{line:55,column:1}},line:42},'5':{name:'(anonymous_5)',decl:{start:{line:57,column:29},end:{line:57,column:30}},loc:{start:{line:57,column:41},end:{line:72,column:1}},line:57},'6':{name:'(anonymous_6)',decl:{start:{line:74,column:30},end:{line:74,column:31}},loc:{start:{line:74,column:43},end:{line:77,column:1}},line:74},'7':{name:'(anonymous_7)',decl:{start:{line:76,column:16},end:{line:76,column:17}},loc:{start:{line:76,column:22},end:{line:76,column:50}},line:76}},branchMap:{'0':{loc:{start:{line:6,column:2},end:{line:7,column:35}},type:'if',locations:[{start:{line:6,column:2},end:{line:7,column:35}},{start:{line:6,column:2},end:{line:7,column:35}}],line:6},'1':{loc:{start:{line:11,column:27},end:{line:11,column:40}},type:'binary-expr',locations:[{start:{line:11,column:27},end:{line:11,column:34}},{start:{line:11,column:38},end:{line:11,column:40}}],line:11},'2':{loc:{start:{line:12,column:27},end:{line:12,column:50}},type:'binary-expr',locations:[{start:{line:12,column:27},end:{line:12,column:44}},{start:{line:12,column:48},end:{line:12,column:50}}],line:12},'3':{loc:{start:{line:19,column:4},end:{line:28,column:8}},type:'if',locations:[{start:{line:19,column:4},end:{line:28,column:8}},{start:{line:19,column:4},end:{line:28,column:8}}],line:19},'4':{loc:{start:{line:43,column:2},end:{line:51,column:7}},type:'if',locations:[{start:{line:43,column:2},end:{line:51,column:7}},{start:{line:43,column:2},end:{line:51,column:7}}],line:43},'5':{loc:{start:{line:43,column:6},end:{line:43,column:50}},type:'binary-expr',locations:[{start:{line:43,column:6},end:{line:43,column:25}},{start:{line:43,column:29},end:{line:43,column:50}}],line:43},'6':{loc:{start:{line:52,column:2},end:{line:53,column:18}},type:'if',locations:[{start:{line:52,column:2},end:{line:53,column:18}},{start:{line:52,column:2},end:{line:53,column:18}}],line:52},'7':{loc:{start:{line:54,column:17},end:{line:54,column:28}},type:'binary-expr',locations:[{start:{line:54,column:17},end:{line:54,column:23}},{start:{line:54,column:27},end:{line:54,column:28}}],line:54},'8':{loc:{start:{line:60,column:4},end:{line:68,column:5}},type:'if',locations:[{start:{line:60,column:4},end:{line:68,column:5}},{start:{line:60,column:4},end:{line:68,column:5}}],line:60},'9':{loc:{start:{line:60,column:8},end:{line:60,column:84}},type:'binary-expr',locations:[{start:{line:60,column:8},end:{line:60,column:29}},{start:{line:60,column:33},end:{line:60,column:59}},{start:{line:60,column:63},end:{line:60,column:84}}],line:60},'10':{loc:{start:{line:64,column:6},end:{line:67,column:26}},type:'if',locations:[{start:{line:64,column:6},end:{line:67,column:26}},{start:{line:64,column:6},end:{line:67,column:26}}],line:64},'11':{loc:{start:{line:66,column:11},end:{line:67,column:26}},type:'if',locations:[{start:{line:66,column:11},end:{line:67,column:26}},{start:{line:66,column:11},end:{line:67,column:26}}],line:66}},s:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0,'8':0,'9':0,'10':0,'11':0,'12':0,'13':0,'14':0,'15':0,'16':0,'17':0,'18':0,'19':0,'20':0,'21':0,'22':0,'23':0,'24':0,'25':0,'26':0,'27':0,'28':0,'29':0,'30':0,'31':0,'32':0,'33':0,'34':0,'35':0,'36':0,'37':0,'38':0,'39':0,'40':0,'41':0,'42':0,'43':0,'44':0},f:{'0':0,'1':0,'2':0,'3':0,'4':0,'5':0,'6':0,'7':0},b:{'0':[0,0],'1':[0,0],'2':[0,0],'3':[0,0],'4':[0,0],'5':[0,0],'6':[0,0],'7':[0,0],'8':[0,0],'9':[0,0,0],'10':[0,0],'11':[0,0]},_coverageSchema:'332fd63041d2c1bcb487cc26dd0d5f7d97098a6c'},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();const Streamz=(cov_21lppx8eza.s[0]++,require('streamz'));const util=(cov_21lppx8eza.s[1]++,require('util'));const Csv=(cov_21lppx8eza.s[2]++,require('csv-parser'));function Csv_parser(options){cov_21lppx8eza.f[0]++;cov_21lppx8eza.s[3]++;if(!(this instanceof Streamz)){cov_21lppx8eza.b[0][0]++;cov_21lppx8eza.s[4]++;return new Csv_parser(options);}else{cov_21lppx8eza.b[0][1]++;}cov_21lppx8eza.s[5]++;Streamz.call(this);cov_21lppx8eza.s[6]++;this.options=options=(cov_21lppx8eza.b[1][0]++,options)||(cov_21lppx8eza.b[1][1]++,{});cov_21lppx8eza.s[7]++;this.options.transform=(cov_21lppx8eza.b[2][0]++,options.transform)||(cov_21lppx8eza.b[2][1]++,{});cov_21lppx8eza.s[8]++;this.csv=Csv(options);const _compile=(cov_21lppx8eza.s[9]++,this.csv._compile);const self=(cov_21lppx8eza.s[10]++,this);cov_21lppx8eza.s[11]++;this.csv._compile=function(){cov_21lppx8eza.f[1]++;cov_21lppx8eza.s[12]++;if(options.sanitize){cov_21lppx8eza.b[3][0]++;cov_21lppx8eza.s[13]++;this.headers=this.headers.map(header=>{cov_21lppx8eza.f[2]++;cov_21lppx8eza.s[14]++;return String(header).trim().toLowerCase().replace(/\./g,'').replace(/\'/g,'').replace(/\s+/g,'_').replace(/\u2013|\u2014/g,'-').replace(/\//g,'_');});}else{cov_21lppx8eza.b[3][1]++;}cov_21lppx8eza.s[15]++;self.emit('headers',this.headers);cov_21lppx8eza.s[16]++;return _compile.call(this);};cov_21lppx8eza.s[17]++;this.csv.on('data',data=>{cov_21lppx8eza.f[3]++;cov_21lppx8eza.s[18]++;return this._push(data);});}cov_21lppx8eza.s[19]++;util.inherits(Csv_parser,Streamz);cov_21lppx8eza.s[20]++;Csv_parser.prototype.base={};cov_21lppx8eza.s[21]++;Csv_parser.prototype.line=1;cov_21lppx8eza.s[22]++;Csv_parser.prototype._fn=function(d){cov_21lppx8eza.f[4]++;cov_21lppx8eza.s[23]++;if((cov_21lppx8eza.b[5][0]++,d instanceof Buffer)||(cov_21lppx8eza.b[5][1]++,typeof d!=='object')){cov_21lppx8eza.b[4][0]++;cov_21lppx8eza.s[24]++;d=Object.create({},{// text should be non-enumerable
text:{value:d.toString('utf8'),writable:true,configurable:true}});}else{cov_21lppx8eza.b[4][1]++;}cov_21lppx8eza.s[25]++;if(typeof d==='object'){cov_21lppx8eza.b[6][0]++;cov_21lppx8eza.s[26]++;this.base=d;}else{cov_21lppx8eza.b[6][1]++;}cov_21lppx8eza.s[27]++;this.csv.write((cov_21lppx8eza.b[7][0]++,d.text)||(cov_21lppx8eza.b[7][1]++,d));};cov_21lppx8eza.s[28]++;Csv_parser.prototype._push=function(d){cov_21lppx8eza.f[5]++;const obj=(cov_21lppx8eza.s[29]++,Object.create(this.base));cov_21lppx8eza.s[30]++;for(let key in d){cov_21lppx8eza.s[31]++;if((cov_21lppx8eza.b[9][0]++,this.options.sanitize)&&(cov_21lppx8eza.b[9][1]++,typeof d[key]==='string')&&(cov_21lppx8eza.b[9][2]++,!d[key].trim().length)){cov_21lppx8eza.b[8][0]++;cov_21lppx8eza.s[32]++;d[key]=undefined;}else{cov_21lppx8eza.b[8][1]++;const transform=(cov_21lppx8eza.s[33]++,this.options.transform[key]);cov_21lppx8eza.s[34]++;if(typeof transform==='function'){cov_21lppx8eza.b[10][0]++;cov_21lppx8eza.s[35]++;obj[key]=transform(d[key]);}else{cov_21lppx8eza.b[10][1]++;cov_21lppx8eza.s[36]++;if(transform!==null){cov_21lppx8eza.b[11][0]++;cov_21lppx8eza.s[37]++;obj[key]=d[key];}else{cov_21lppx8eza.b[11][1]++;}}}}cov_21lppx8eza.s[38]++;obj.__line=++this.line;cov_21lppx8eza.s[39]++;this.push(obj);};cov_21lppx8eza.s[40]++;Csv_parser.prototype._flush=function(cb){cov_21lppx8eza.f[6]++;cov_21lppx8eza.s[41]++;this.csv.end();cov_21lppx8eza.s[42]++;setImmediate(()=>{cov_21lppx8eza.f[7]++;cov_21lppx8eza.s[43]++;return Streamz.prototype._flush(cb);});};cov_21lppx8eza.s[44]++;module.exports=Csv_parser;